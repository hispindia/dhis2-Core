<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<!-- use the DHIS web portal default -->
	<include file="dhis-web-commons.xml" />

	<package name="dhis-web-excelimport" extends="dhis-web-commons"
		namespace="/dhis-web-excelimport">

		<action name="index" class="org.hisp.dhis.excelimport.action.NoAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/welcome.vm</param>
			<param name="menu">/dhis-web-excelimport/menu.vm</param>
		</action>

		<action name="excelImportForm"
			class="org.hisp.dhis.excelimport.action.ExcelImportFormAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/excelImportForm.vm</param>
			<param name="menu">/dhis-web-excelimport/menuWithTree.vm</param>
			<param name="javascripts">
				../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/reports.js,javascript/hashtable.js
				,../dhis-web-commons/util/validate/jquery.validate.js,../dhis-web-commons/util/jquery.metadata.js
				,../dhis-web-commons/util/validate/additional-methods.js,../dhis-web-commons/util/validate/messages_locale.js</param>
			<param name="stylesheets">css/StylesForTags.css</param>
			<interceptor-ref name="organisationUnitTreeStack" />
		</action>

		<action name="excelResultForm"
			class="org.hisp.dhis.excelimport.action.ExcelImportResultAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/responseStatus.vm</param>
			<param name="menu">/dhis-web-excelimport/menu.vm</param>
			<interceptor-ref name="fileUploadStack" />
		</action>

		<action name="validateExcelImportUpdateData"
			class="org.hisp.dhis.excelimport.action.ValidateExcelImportUpdateData">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/validateStatus.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<action name="rejectImport" class="org.hisp.dhis.excelimport.action.RejectAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/invalidReport.vm</param>
			<param name="menu">/dhis-web-excelimport/menuWithTree.vm</param>
			<param name="javascripts">
				../dhis-web-commons/ouwt/ouwt.js,../dhis-web-commons/lists/lists.js,javascript/reports.js,javascript/reports.js,javascript/hashtable.js</param>
			<param name="stylesheets">css/StylesForTags.css</param>
			<interceptor-ref name="organisationUnitTreeStack" />
			<interceptor-ref name="fileUploadStack" />
		</action>


		<!-- AJAX Requests -->
		<action name="getDataElements"
			class="org.hisp.dhis.excelimport.action.GetDataElementsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responseDataElement.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<!-- Get Periods -->
		<action name="getPeriods"
			class="org.hisp.dhis.excelimport.action.GetPeriodsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responsePeriod.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<!-- Get Weekly Periods -->
		<action name="getWeeklyPeriods"
			class="org.hisp.dhis.excelimport.action.GetWeeklyPeriodsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responsePeriod.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<action name="getReports"
			class="org.hisp.dhis.excelimport.action.GetReportsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responseImportReport.vm
			</result>
			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js,../dhis-web-commons/lists/lists.js,javascript/hashtable.js</param>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<action name="getOrgUnitDetails"
			class="org.hisp.dhis.excelimport.action.GetOrgUnitsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responseOrgUnit.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>

		<!-- Export Xls File -->
		<action name="exportExcelFile"
			class="org.hisp.dhis.exceliexport.action.ExcelExportResultAction">
			<result name="success" type="stream">
				<param name="contentType">application/vnd.ms-excel</param>
				<param name="inputName">inputStream</param>
				<param name="contentDisposition">filename="${fileName}"</param>
				<param name="bufferSize">1024</param>
			</result>
		</action>

		<!-- exportForm -->
		<action name="exportForm"
			class="org.hisp.dhis.excelimport.export.action.ExportFormAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/exportForm.vm</param>
			<param name="menu">/dhis-web-excelimport/menu.vm</param>
			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js,javascript/hashtable.js</param>
			<param name="stylesheets">css/StylesForTags.css</param>
			<param name="requiredAuthorities">F_EXPORT_GLOBAL</param>
		</action>

		<action name="exportDataResult"
			class="org.hisp.dhis.excelimport.export.action.ExportDataResultAction">
			<result name="success" type="stream">
				<param name="contentType">application/vnd.ms-excel</param>
				<param name="inputName">inputStream</param>
				<param name="contentDisposition">filename="${fileName}"</param>
				<param name="bufferSize">1024</param>
			</result>
		</action>

		<!-- importForm -->
		<action name="importForm"
			class="org.hisp.dhis.excelimport.importexcel.action.ImportFormAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/importForm.vm</param>
			<param name="menu">/dhis-web-excelimport/menu.vm</param>
			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js,javascript/hashtable.js</param>
			<param name="stylesheets">css/StylesForTags.css</param>
			<param name="requiredAuthorities">F_IMPORT_ECMIS</param>
		</action>

		<!-- <action name="importDataResult" class="org.hisp.dhis.excelimport.importexcel.action.ImportDataResultAction"> 
			<result name="success" type="stream"> <param name="contentType">application/vnd.ms-excel</param> 
			<param name="inputName">inputStream</param> <param name="contentDisposition">filename="${fileName}"</param> 
			<param name="bufferSize">1024</param> </result> </action> -->

		<action name="importDataResult"
			class="org.hisp.dhis.excelimport.importexcel.action.ImportDataResultAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/importDataResult.vm</param>
			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js,javascript/hashtable.js</param>
			<interceptor-ref name="fileUploadStack" />
			<!-- <param name="requiredAuthorities">F_IMPORT_DATA</param> -->
		</action>

		<!-- Dataset assignment Editor -->
	    <action name="displayDataSetAssignEditorForm" class="org.hisp.dhis.excelimport.action.NoAction">
	      <result name="success" type="velocity">/main.vm</result>
	      <param name="page">/dhis-web-excelimport/viewDataSetAssignEditorForm.vm</param>
	      <param name="menu">/dhis-web-excelimport/menu.vm</param>
	      <param name="javascripts">../dhis-web-commons/oust/oust.js,javascript/dataSetAssignEditor.js</param>
	      <param name="anyAuthorities">F_MULTIPLE_DATASET_ASSIGN_EDITOR</param>
	    </action>
	    
		<!-- Dataset assignment Editor -->
		<action name="excelImportEventDataValueForm"
			class="org.hisp.dhis.excelimport.action.ExcelImportEventDataValueFormAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/excelImportEventDataValueForm.vm</param>
			<param name="menu">/dhis-web-excelimport/menuWithTree.vm</param>
			<param name="javascripts">../dhis-web-commons/ouwt/ouwt.js,javascript/reports.js</param>
			<param name="stylesheets">css/StylesForTags.css</param>
			<interceptor-ref name="organisationUnitTreeStack" />
		</action>

		<action name="excelDataValueSetResult"
			class="org.hisp.dhis.excelimport.action.ExcelImportEventDataValueAction">
			<result name="success" type="velocity">/main.vm</result>
			<param name="page">/dhis-web-excelimport/responseEventImportStatus.vm</param>
			<param name="menu">/dhis-web-excelimport/menu.vm</param>
			<interceptor-ref name="fileUploadStack" />
		</action>

		<!-- Get Quarterly Periods -->
		<action name="getQuarterlyPeriods"
			class="org.hisp.dhis.excelimport.action.GetQuarterlyPeriodsAction">
			<result name="success" type="velocity-xml">/dhis-web-excelimport/responsePeriod.vm
			</result>
			<param name="onExceptionReturn">plainTextError</param>
		</action>


	    	    
	</package>
</struts>
